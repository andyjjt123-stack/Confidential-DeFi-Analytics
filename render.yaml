services:
  # ① Spring Boot 後端（Web Service, Docker）
  - type: web
    name: cda-backend
    env: docker
    plan: free
    autoDeploy: true
    dockerContext: ./backend
    dockerfilePath: ./backend/Dockerfile
    envVars:
      - key: JAVA_TOOL_OPTIONS
        value: "-XX:MaxRAMPercentage=75.0"
      - key: STABLE_RPC_URL
        sync: false
      - key: PRIVATE_KEY
        sync: false
      - key: CONTRACT_ADDRESS
        sync: false
      - key: CHAIN_ID
        value: "2201"

  # ② Vite 前端（也當作 Web Service 跑 Docker）
  - type: web
    name: cda-frontend
    env: docker
    plan: free
    autoDeploy: true
    dockerContext: ./frontend
    dockerfilePath: ./frontend/Dockerfile
    envVars:
      - key: VITE_API_BASE
        sync: false          # 這裡填你的後端 URL
    dockerBuildArgs:         # ⬅ 新增這行與內容
      - VITE_API_BASE
    healthCheckPath: /

